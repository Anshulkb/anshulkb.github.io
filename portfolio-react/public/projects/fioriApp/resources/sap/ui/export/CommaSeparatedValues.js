/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.define(["./library","sap/base/Log","sap/ui/export/js/CSVBuilder","sap/ui/export/ExportBase","sap/ui/export/ExportUtils"],function(e,t,r,o,a){"use strict";const s=e.FileType;const i=o.extend("sap.ui.export.CommaSeparatedValues",{});i.prototype.cancel=function(){if(!this._bIsCancelled){this._bIsCancelled=true}return this};i.prototype.processDataSource=function(e){const r=typeof e;const o={data:[],type:"array"};if(!e){return null}if(r!=="object"){t.error("CommaSeparatedValues#processDataSource: Unable to apply data source of type "+r);return null}if(e.dataUrl){t.error("CommaSeparatedValues#processDataSource: URLs (such as dataUrl) are not supported as data sources. Type: "+r);return null}if(Array.isArray(e)){o.data=e}if(e.isA?.("sap.ui.model.ClientListBinding")){const t=[];e.getAllCurrentContexts().forEach(function(e){t.push(e.getObject())});o.data=t}return o};i.prototype.setDefaultExportSettings=function(e){if(!e.fileType){e.fileType=s.CSV}if(!e.workbook.separator){e.workbook.separator=","}return Promise.resolve()};i.prototype.createBuildPromise=function(e){try{if(this._oBuilder){return Promise.reject("Cannot start export: The process is already running")}const t=e.workbook;this._bIsCancelled=false;this._oBuilder=new r(t.columns,t.separator);this._oBuilder.append(e.dataSource.data);const o=this._oBuilder.build();if(!this._bIsCancelled){a.saveAsFile(o,e.fileName)}this._oBuilder=null;return Promise.resolve()}catch(e){return Promise.reject(e)}};i.prototype.getMimeType=function(){return"text/csv"};return i});
//# sourceMappingURL=CommaSeparatedValues.js.map